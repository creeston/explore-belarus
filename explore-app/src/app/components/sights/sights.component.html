<div class="container-fluid">
  <div class="row g-0">
    <div class="col-lg-3" #mapContainer id="mapContainer">
      <div class="sticky-top">
        <div class="row">
          <svg attr.height="{{height}}px" attr.width="{{width}}px" mlns="http://www.w3.org/2000/svg"
            xmlns:xlink="http://www.w3.org/1999/xlink">
            <image href="assets/map.svg" attr.height="{{height}}px" attr.width="{{width}}px" />
            <!-- <g *ngIf="activeIndex === 0">
              <circle *ngFor="let place of places" attr.cx="{{getPlaceCoordX(place)}}"
                attr.cy="{{getPlaceCoordY(place)}}" r="1" style="fill: #F3D991; stroke: #F3D991; stroke-width: 1px;"
                attr.id="place{{place.id}}"></circle>
            </g>
            <g *ngIf="activeIndex === 1">
              <circle *ngFor="let place of highlightedPlaces" attr.cx="{{getPlaceCoordX(place)}}"
                attr.cy="{{getPlaceCoordY(place)}}" r="1" style="fill: #F3D991; stroke: #F3D991; stroke-width: 1px;"
                attr.id="place{{place.id}}"></circle>
            </g>
            <g *ngIf="activeIndex === 2">
              <circle *ngFor="let place of visitedPlaces" attr.cx="{{getPlaceCoordX(place)}}"
                attr.cy="{{getPlaceCoordY(place)}}" r="1" style="fill: #F3D991; stroke: #F3D991; stroke-width: 1px;"
                attr.id="place{{place.id}}"></circle>
            </g> -->

            <g *ngIf="viewSelector === 'places'">
              <circle *ngFor="let place of places" attr.cx="{{getPlaceCoordX(place)}}"
                attr.cy="{{getPlaceCoordY(place)}}" r="1" style="fill: #F3D991; stroke: #F3D991; stroke-width: 1px;"
                attr.id="place{{place.id}}"></circle>
            </g>
            <g *ngIf="viewSelector === 'sights'">
              <circle *ngFor="let sight of sights"
                attr.cx="{{getPlaceCoordX(sight.place)}}"
                attr.cy="{{getPlaceCoordY(sight.place)}}" r="1" style="fill: #F3D991; stroke: #F3D991; stroke-width: 1px;"
                attr.id="place{{sight.place.id}}"></circle>
            </g>

          </svg>
        </div>
        <div class="row mt-3">
          <div class="col align-self-center">
            <h5>Фильтры</h5>
          </div>

          <div class="col col-auto">
            <button type="button" class="btn btn-link reset-button" (click)="resetFilters()">Сбросить</button>
          </div>

        </div>
        <div class="row mt-3">
          <label for="rangeValue">Область</label>
          <p-multiSelect [options]="regions" [(ngModel)]="selectedRegions" placeholder="Выберите область"
            (onChange)="filterData()" autoWidth="false" [style]="{'width':'100%', 'maxHeight': '48px'}"
            [showHeader]="false"></p-multiSelect>
        </div>
        <div class="row mt-3">
          <label for="rangeValue">Рейтинг</label>
          <p-multiSelect [options]="ratings" [(ngModel)]="selectedRatings" placeholder="Выберите рейтинг"
            (onChange)="filterData()" autoWidth="false" [style]="{'width':'100%', 'maxHeight': '48px'}"
            [showHeader]="false"></p-multiSelect>
        </div>
        <!-- <div class="row mt-3">
          <label style="margin-bottom: 5px" for="rangeValue">Расстояние до: {{ rangeValue }}км</label>
          <p-slider [(ngModel)]="rangeValue" id="rangeValue" max="500" min="0"></p-slider>
        </div> -->
        <div class="row mt-3">
          <div class="p-field-checkbox flex gap-2">
            <p-checkbox [(ngModel)]="showOnlyNonVisited" (ngModelChange)="filterData()" binary="true"
              inputId="binary"></p-checkbox>
            <label for="binary">Только непосещенные места</label>
          </div>
        </div>
      </div>

    </div>
    <div class="col-lg-1" *ngIf="innerWidth > 1000">
      <p-divider layout="vertical" />
    </div>
    <div class="col-lg-8">
      <div class="row">
        <!-- <div class="d-flex">
          <div class="p-2"><span class="p-input-icon-left">
            <i class="pi pi-search"></i>
            <input type="text" pInputText [(ngModel)]="searchValue" (ngModelChange)="filterData()" />
          </span></div>
          <div class="p-2"><mat-button-toggle-group [(ngModel)]="viewSelector">
            <mat-button-toggle value="places" class="view-selector-button">
              <mat-icon fontIcon="home_work"></mat-icon>
              Населенные пункты
            </mat-button-toggle>
            <mat-button-toggle value="sights" class="view-selector-button">
              <mat-icon fontIcon="church"></mat-icon>
              Достопримечательности
            </mat-button-toggle>
          </mat-button-toggle-group></div>
      </div> -->

        <div class="col-xl-auto col-lg-6 col-sm-8 col-12">
          <span class="p-input-icon-left" style="width:100%; min-width: 250px;">
            <i class="pi pi-search"></i>
            <input style="width: 100%" type="text" pInputText [(ngModel)]="searchValue" (ngModelChange)="filterData()" />
          </span>
        </div>
        <div class="col-12 col-sm-auto d-flex justify-content-center">
          <mat-button-toggle-group [(ngModel)]="viewSelector">
            <mat-button-toggle value="places">
              <mat-icon fontIcon="home_work"></mat-icon>
              <span *ngIf="innerWidth > 1000" class="view-selector-button">Населенные пункты</span>
              
            </mat-button-toggle>
            <mat-button-toggle value="sights">
              <mat-icon fontIcon="church"></mat-icon>
              <span *ngIf="innerWidth > 1000" class="view-selector-button">Достопримечательности</span>
            </mat-button-toggle>
          </mat-button-toggle-group>
        </div>
        <div class="col">

        </div>

      </div>
      <!-- <mat-tab-group *ngIf="places">
        <mat-tab label="Города">
          <div class="row g-0" infinite-scroll [infiniteScrollDistance]="2" [infiniteScrollThrottle]="1000"
            (scrolled)="onScroll()">
            <div class="col" *ngFor="let place of nonVisitedPlaces; let i = index;">
              <app-place-card [place]="place" (hover)="onHover($event, place)"></app-place-card>
            </div>
          </div>
        </mat-tab>
        <mat-tab label="Достопримечательности">
          <div class="row g-0" infinite-scroll [infiniteScrollDistance]="2" [infiniteScrollThrottle]="1000"
            (scrolled)="onScroll()">
            <div class="col" *ngFor="let place of nonVisitedPlaces; let i = index;">
              <app-place-card [place]="place" (hover)="onHover($event, place)"></app-place-card>
            </div>
          </div>
        </mat-tab>
        <mat-tab label="Хочу посетить">
          <div class="row g-0">
            <div class="col" *ngFor="let place of highlightedPlaces; let i = index;">
              <app-place-card [place]="place" (hover)="onHover($event, place)"></app-place-card>
            </div>
          </div>
        </mat-tab>
        <mat-tab label="Посещенные">
          <div class="row g-0">
            <div class="col" *ngFor="let place of visitedPlaces; let i = index;">
              <app-place-card [place]="place" (hover)="onHover($event, place)"></app-place-card>
            </div>
          </div>
        </mat-tab>
      </mat-tab-group> -->

      <div *ngIf="places" class="row places-container mt-3">
        <div *ngIf="viewSelector === 'places'" class="row" infinite-scroll [infiniteScrollDistance]="2"
          [infiniteScrollThrottle]="1000" (scrolled)="onScroll()" [class.g-0]="innerWidth < 500">
          <div class="col-12 col-sm d-flex justify-content-center" *ngFor="let place of places; let i = index;">
            <app-place-card [place]="place" (hover)="onHover($event, place)"></app-place-card>
          </div>
        </div>
        <div *ngIf="viewSelector === 'sights'" class="row" infinite-scroll [infiniteScrollDistance]="2"
        [infiniteScrollThrottle]="1000" (scrolled)="onSightsScroll()">
          <div class="col" *ngFor="let sight of sights; let i = index;">
            <app-sight-card [sight]="sight" (hover)="onHover($event, sight.place)"></app-sight-card>
          </div>
        </div>
      </div>


      <!-- <div *ngIf="places" class="row places-container mt-3">
        <p-tabView [(activeIndex)]="activeIndex">
          <p-tabPanel header="Города">
            <div class="row" infinite-scroll [infiniteScrollDistance]="2" [infiniteScrollThrottle]="1000"
              (scrolled)="onScroll()">
              <div class="col" *ngFor="let place of places; let i = index;">
                <app-place-card [place]="place" (hover)="onHover($event, place)"></app-place-card>
              </div>
            </div>
          </p-tabPanel>
          <p-tabPanel header="Достопримечательности">
            <div class="row">
              <div class="col" *ngFor="let place of highlightedPlaces; let i = index;">
                <app-place-card [place]="place" (hover)="onHover($event, place)"></app-place-card>
              </div>
            </div>
          </p-tabPanel>
        </p-tabView>
      </div> -->

    </div>
  </div>
</div>




<!-- <div id="grid" [style.visibility]="gridLoading ? 'hidden': 'visible'">
    <ng-masonry-grid (onNgMasonryInit)="onNgMasonryInit($event)" [masonryOptions]="{ transitionDuration: '0.8s', columnWidth: '.grid-sizer', percentPosition: true, itemSelector: '.grid-item' }" >
      <div class="grid-sizer"></div>
      <ng-masonry-grid-item id="{{'masonry-item-'+i}}" *ngFor="let sight of sights; let i = index;">
        <div (mouseenter)="enterSight(i)" (mouseleave)="leaveSight(i)" [class]= "'sight' + sight.rate + ' grid-item'">
          <div [class]= "'innerSight' + sight.rate" [style]="setSightStyle(sight)"></div>
        </div>
      </ng-masonry-grid-item>
    </ng-masonry-grid>
  </div> -->